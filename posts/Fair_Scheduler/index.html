<!DOCTYPE html><html lang="ko-KR" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8829030678254956" crossorigin="anonymous"></script><meta name="pv-proxy-endpoint" content=""><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Apache Hadoop - Fair Scheduler" /><meta name="author" content="leeyh0216" /><meta property="og:locale" content="ko_KR" /><meta name="description" content="출처 Untangling Apache Hadoop YARN, Part 3: Scheduler Concepts Untangling Apache Hadoop YARN, Part 4: Fair Scheduler Queue Basics" /><meta property="og:description" content="출처 Untangling Apache Hadoop YARN, Part 3: Scheduler Concepts Untangling Apache Hadoop YARN, Part 4: Fair Scheduler Queue Basics" /><link rel="canonical" href="https://leeyh0216.github.io/posts/Fair_Scheduler/" /><meta property="og:url" content="https://leeyh0216.github.io/posts/Fair_Scheduler/" /><meta property="og:site_name" content="leeyh0216’s devlog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2019-11-16T14:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Apache Hadoop - Fair Scheduler" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@leeyh0216" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"leeyh0216"},"description":"출처 Untangling Apache Hadoop YARN, Part 3: Scheduler Concepts Untangling Apache Hadoop YARN, Part 4: Fair Scheduler Queue Basics","url":"https://leeyh0216.github.io/posts/Fair_Scheduler/","@type":"BlogPosting","headline":"Apache Hadoop - Fair Scheduler","dateModified":"2019-11-16T14:00:00+09:00","datePublished":"2019-11-16T14:00:00+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://leeyh0216.github.io/posts/Fair_Scheduler/"},"@context":"https://schema.org"}</script><title>Apache Hadoop - Fair Scheduler | leeyh0216's devlog</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/npm/countup.js@1.9.3/dist/countUp.min.js"></script> <script async src="/assets/js/dist/pvreport.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-129061352-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-129061352-1'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://cdn.jsdelivr.net/gh/cotes2020/chirpy-images/commons/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">leeyh0216's devlog</a></div><div class="site-subtitle font-italic">개발/일상 블로그</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/leeyh0216" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://www.linkedin.com/in/%EC%9A%A9%ED%99%98-%EC%9D%B4-84222a119/" aria-label="linkedin" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['leeyh0216','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Apache Hadoop - Fair Scheduler</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Apache Hadoop - Fair Scheduler</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> leeyh0216 </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, Nov 16, 2019, 2:00 PM +0900" prep="on" > Nov 16, 2019 <i class="unloaded">2019-11-16T14:00:00+09:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3169 words">17 min</span> <span id="pv" class="pageviews"><i class="fas fa-spinner fa-spin fa-fw"></i></span></div></div><div class="post-content"><blockquote><p>출처</p><p><a href="https://blog.cloudera.com/untangling-apache-hadoop-yarn-part-3-scheduler-concepts/">Untangling Apache Hadoop YARN, Part 3: Scheduler Concepts</a></p><p><a href="https://clouderatemp.wpengine.com/blog/2016/06/untangling-apache-hadoop-yarn-part-4-fair-scheduler-queue-basics/">Untangling Apache Hadoop YARN, Part 4: Fair Scheduler Queue Basics</a></p></blockquote><h1 id="yarn-scheduler">Yarn Scheduler</h1><p>단일 컴퓨터는 하나의 Process를 실행 시킬 수 있는 Core를 여러 개 가진 CPU를 가지고 있다. 수 백개의 Process를 동시에 수행할 수 있도록 운영체제에는 스케쥴러가 존재한다.</p><p>클러스터에서 수행되는 어플리케이션은 서로 다른 노드에서 수행되는 수십 개의 작업으로 구성되어 있다. 그렇기 때문에 클러스터의 스케쥴러는 다음과 같은 문제를 해결해야 한다.</p><ul><li>Multi-tenancy: 클러스터에는 서로 다른 조직의 사용자들이 여러 종류의 어플리케이션을 수행할 수 있다. 클러스터의 스케쥴러는 다양한 워크 로드를 동시에 수행할 수 있어야 한다.<li>Scalability: 클러스터의 스케쥴러는 시스템 지연 없이 클러스터의 크기를 확장할 수 있어야 한다.</ul><h2 id="scheduling-in-yarn">Scheduling in YARN</h2><p>ResourceManager는 클러스터의 자원을 추적하고, 자원을 필요로 하는 어플리케이션에게 자원을 할당한다. 스케쥴러는 리소스를 공유하는 역할을 수행하는 ResourceManager의 모듈이다.</p><ul><li>Yarn은 다양한 사용자에게 자원을 공유하기 위해 Queue를 사용한다.<li>ApplicationMaster는 자신이 수행하는 작업이 필요한 자원을 조정하여 ResourceManager에게 요청하고, 할당받은 자원을 다시 작업들에게 할당한다. 즉, ResourceManager는 클러스터에서 수행되는 모든 Container(작업)의 자원 할당에 관여할 필요 없이 ApplicationMaster 단위로의 자원 할당을 수행하면 된다.</ul><h2 id="introducing-queues">Introducing Queues</h2><p>Yarn 스케쥴러는 다양한 사용자들에게 클러스터의 자원을 할당하는 Queue로 구성되어 있다. YARN에서 수행되는 Application 들은 자신이 수행되어야 할 Queue를 할당받게 된다.</p><p><code class="language-plaintext highlighter-rouge">root</code> Queue는 모든 Queue의 부모이며, <code class="language-plaintext highlighter-rouge">root</code> 하위의 Queue들은 모두 <code class="language-plaintext highlighter-rouge">root</code> Queue의 자식이며, 또 다시 자신의 자식을 가질 수 있다. 즉, Queue들이 Hierarchical 하게 구성될 수 있다.</p><ul><li><code class="language-plaintext highlighter-rouge">root</code><ul><li><code class="language-plaintext highlighter-rouge">marketing</code><li><code class="language-plaintext highlighter-rouge">development</code><ul><li><code class="language-plaintext highlighter-rouge">ETL</code><li><code class="language-plaintext highlighter-rouge">adhoc</code></ul><li><code class="language-plaintext highlighter-rouge">streaming</code></ul></ul><p>예를 들어 위와 같은 Queue는 <code class="language-plaintext highlighter-rouge">root</code> 아래에 <code class="language-plaintext highlighter-rouge">marketing</code>, <code class="language-plaintext highlighter-rouge">development</code>, <code class="language-plaintext highlighter-rouge">streaming</code> 등 3개의 Queue가 존재하며, <code class="language-plaintext highlighter-rouge">development</code> 아래에는 다시 <code class="language-plaintext highlighter-rouge">ETL</code>과 <code class="language-plaintext highlighter-rouge">adhoc</code> 등의 자식 Queue가 존재한다.</p><h3 id="queue-naming">Queue Naming</h3><p>Hierarchical 하게 구성된 Queue는 <code class="language-plaintext highlighter-rouge">.</code>을 이용하여 단계를 나타낸다. 예를 들어 위의 Queue에서 <code class="language-plaintext highlighter-rouge">adhoc</code>의 이름은 <code class="language-plaintext highlighter-rouge">root.development.adhoc</code>과 같이 표현할 수 있다.</p><h3 id="queue-weights">Queue Weights</h3><p>Queue에게 할당되는 자원의 비중 또한 Hierarchical 하게 구성된다. 아래와 같이 Queue에 Weight가 할당되었다고 가정해보자.</p><ul><li><code class="language-plaintext highlighter-rouge">root</code><ul><li><code class="language-plaintext highlighter-rouge">marketing</code>: 0.1<li><code class="language-plaintext highlighter-rouge">development</code>: 0.7<ul><li><code class="language-plaintext highlighter-rouge">ETL</code>: 0.4<li><code class="language-plaintext highlighter-rouge">adhoc</code>: 0.6</ul><li><code class="language-plaintext highlighter-rouge">streaming</code>: 0.2</ul></ul><p><code class="language-plaintext highlighter-rouge">root.marketing</code>과 <code class="language-plaintext highlighter-rouge">root.streaming</code>에는 각각 10%, 20%의 자원이 할당된다. <code class="language-plaintext highlighter-rouge">development</code>는 70%를 할당받으며, 다시 자식인 <code class="language-plaintext highlighter-rouge">ETL</code>과 <code class="language-plaintext highlighter-rouge">adhoc</code>은 부모 Queue인 <code class="language-plaintext highlighter-rouge">development</code>에게 할당된 70%의 0.4, 0.6 씩인 28%, 42% 씩을 할당받는다. 위의 Weight를 %로 표기해보면 아래와 같다.</p><ul><li><code class="language-plaintext highlighter-rouge">root</code><ul><li><code class="language-plaintext highlighter-rouge">marketing</code>: 10%<li><code class="language-plaintext highlighter-rouge">development</code><ul><li><code class="language-plaintext highlighter-rouge">ETL</code>: 28%<li><code class="language-plaintext highlighter-rouge">adhoc</code>: 42%</ul><li><code class="language-plaintext highlighter-rouge">streaming</code>: 20%</ul></ul><h2 id="fair-scheduler-queue-basics">Fair Scheduler Queue basics</h2><h3 id="queue-properties">Queue Properties</h3><h4 id="fairshare">FairShare</h4><p>FairShare는 YARN 클러스터의 리소스의 양을 의미한다. 예를 들어 YARN 클러스터의 리소스가 100GB 메모리, 25VCore로 구성되어 있다면 FairShare는 &lt;memory:100GB, vcores:25&gt;와 같이 표기한다.</p><h5 id="share-weights">Share Weights</h5><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>&lt;weight&gt;0.5&lt;weight&gt;
</pre></table></code></div></div><p>위와 같이 Queue의 Weight를 표기할 수 있다. 만일 Yarn 클러스터의 전체 FairShare가 &lt;memory:100GB,vcores:50&gt; 인데, Queue X의 Weight가 0.5인 경우 Queue X는 &lt;memory:50GB, vcores:25&gt;의 리소스를 할당받는다.</p><p>다만 <strong>Fair Share는 자신 혹은 자식 Queue가 1개 이상의 실행 중인 Application을 가지고 있을 때에만 적용된다.</strong></p><p>8 Core, 16GB Memory의 장비에 아래와 같이 Queue를 구성해 보았다.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>&lt;allocations&gt;
  &lt;queue name="marketing"&gt;
    &lt;weight&gt;2.0&lt;/weight&gt;
    &lt;schedulingPolicy&gt;fair&lt;/schedulingPolicy&gt;
  &lt;/queue&gt;
  &lt;queue name="development"&gt;
    &lt;weight&gt;8.0&lt;/weight&gt;
    &lt;schedulingPolicy&gt;fair&lt;/schedulingPolicy&gt;
  &lt;/queue&gt;
&lt;/allocations&gt;
</pre></table></code></div></div><p>두 Queue에 아무 Application도 동작 중이지 않은 경우에는 두 Queue 모두 Fair Share가 &lt;memory:0GB, vcores:0&gt;이 된다.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="../assets/hadoop/../../../assets/hadoop/fair_share_no_application.png" alt="Fair Share - No Applications" /></p><p>이 상황에서 development Queue에 Application을 1개 실행하면, 아래와 같이 development Queue의 Fair Share가 &lt;memory:8GB, vcores:0&gt;이 되는 것을 확인할 수 있다. 반면 marketing Queue에는 실행 중인 Application이 존재하지 않기 때문에 &lt;memory:0GB, vcores:0&gt;의 Fair Share를 가지는 것을 볼 수 있다.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="../assets/hadoop/../../../assets/hadoop/fair_share_one_application.png" alt="Fair Share - One Application" /></p><p><code class="language-plaintext highlighter-rouge">development</code> Queue에서 아직 Application이 실행되고 있는 상태에서 <code class="language-plaintext highlighter-rouge">marketing</code> Queue에 Application을 1개 실행시키면, Queue 설정의 Weight 비율과 같이 Fair Share가 2:8의 비율로 구성되는 것을 아래와 같이 확인할 수 있다.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="../assets/hadoop/../../../assets/hadoop/fair_share_two_application.png" alt="Fair Share - Two Application" /></p><p>다만 Fair Share가 위와 같이 2:8 비율로 변경되었다 해서, <code class="language-plaintext highlighter-rouge">marketing</code> Queue에서 실행된 Application이 바로 실행될 수 있는 것은 아니다.(이와 관련해서는 Preemption을 이해해야 한다.) 위 그림에서도 Fair Share가 1,638인데도 Application의 상태가 ACCEPTED로 되어 있는 것을 확인할 수 있다.</p><p>결론적으로 Fair Share는 다음과 같은 특성을 가진다.</p><ul><li>Cluster Resource가 증가함에 따라, Fair Share도 증가한다.<li>Cluster를 구성하는 Queue의 상태(Application의 실행 여부)에 따라 Fair Share가 달라진다.</ul><h4 id="resource-constraints">Resource Constraints</h4><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>&lt;minResources&gt;20000mb, 10 vcores&lt;/minResources&gt;
&lt;maxResources&gt;2000000mb, 1000 vcores&lt;/maxResources&gt;
</pre></table></code></div></div><p>Queue의 Resource를 제한하는 방법에는 <code class="language-plaintext highlighter-rouge">minResources</code>와 <code class="language-plaintext highlighter-rouge">maxResources</code>가 존재한다.</p><p><code class="language-plaintext highlighter-rouge">minResources</code>는 약한 제약조건이다. 이 값은 Queue가 요청하는 최소한의 리소스 요구사항이며, 다음 조건들을 만족해야만 <code class="language-plaintext highlighter-rouge">minResources</code>만큼의 리소스를 확보할 수 있다.</p><ul><li><code class="language-plaintext highlighter-rouge">minResources</code>만큼의 리소스가 클러스터에 남아 있거나, 리소스가 클러스터에 남아 있지 않더라도 다른 Queue로부터 Preemption이 가능한 경우<li><code class="language-plaintext highlighter-rouge">minResources</code>의 총 합이 Cluster의 총 리소스 양보다 크지 않은 경우</ul><p><code class="language-plaintext highlighter-rouge">maxResource</code>는 강한 제약조건이다. 이 옵션이 적용된 Queue와 자식 Queue들의 총 사용 리소스의 합이 반드시 해당 값보다 작아야 한다.</p><p><code class="language-plaintext highlighter-rouge">minResources</code>와 <code class="language-plaintext highlighter-rouge">maxResources</code>는 아래와 같은 단점이 있기 때문에 권장되는 옵션이 아니다.</p><ul><li><code class="language-plaintext highlighter-rouge">minResources</code>와 <code class="language-plaintext highlighter-rouge">maxResources</code>에 적용되는 옵션은 정적(명확한 Memory와 Core가 정해져 있음)이기 때문에, 클러스터의 구성(노드가 추가되거나 제거되는 등)이 변경될 때마다 바꾸어 주어야 한다.<li><code class="language-plaintext highlighter-rouge">maxResources</code>의 경우 클러스터의 사용률이 낮은 경우(리소스가 남는 경우)에도 이 값을 넘어서는 리소스를 사용할 수 없다.<li><code class="language-plaintext highlighter-rouge">minResources</code>의 리소스가 FairShare를 넘어서는 경우 다른 Queue의 Fair Share에도 영향을 미친다.</ul><h5 id="minresources를-weight-값에-의해-계산되는-리소스의-양보다-크게-만들어보기"><code class="language-plaintext highlighter-rouge">minResources</code>를 Weight 값에 의해 계산되는 리소스의 양보다 크게 만들어보기</h5><p>위의 <code class="language-plaintext highlighter-rouge">minResources</code>의 단점 중, <code class="language-plaintext highlighter-rouge">minResources</code>가 FairShare를 넘어서는 경우 다른 Queue의 Fair Share에도 영향을 미친다는 내용이 있었다.</p><p>이를 테스트하기 위해, fair scheduler의 옵션을 아래와 같이 변경하였다.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>&lt;allocations&gt;
  &lt;queue name="marketing"&gt;
    &lt;weight&gt;2.0&lt;/weight&gt;
    &lt;schedulingPolicy&gt;fair&lt;/schedulingPolicy&gt;
    &lt;minResources&gt;2048mb, 2 vcores&lt;/minResources&gt;
  &lt;/queue&gt;
  &lt;queue name="development"&gt;
    &lt;weight&gt;8.0&lt;/weight&gt;
    &lt;schedulingPolicy&gt;fair&lt;/schedulingPolicy&gt;
  &lt;/queue&gt;
  &lt;queueMaxAMShareDefault&gt;0.5&lt;/queueMaxAMShareDefault&gt;
&lt;/allocations&gt;
</pre></table></code></div></div><p>장비의 Spec이 8GB Memory이기 때문에, weight만 가지고 Fair Share를 계산했을 때에는 아래와 같이 Fair Share가 구성되어야 한다.</p><ul><li><code class="language-plaintext highlighter-rouge">marketing</code>: 1,638MB Memory<li><code class="language-plaintext highlighter-rouge">development</code>: 6,554MB Memory</ul><p>그러나 <code class="language-plaintext highlighter-rouge">marketing</code> Queue에는 <code class="language-plaintext highlighter-rouge">minResources</code>를 2,048MB로 적용했기 때문에, 기존 Weight 값으로 설정된 Fair Share를 무시하고 다음과 같이 구성되어야 한다.</p><ul><li><code class="language-plaintext highlighter-rouge">marketing</code>: 2,048MB Memory<li><code class="language-plaintext highlighter-rouge">development</code>: 6,144MB Memory</ul><p>적용해본 결과, 아래와 같이 <code class="language-plaintext highlighter-rouge">minResources</code>에 설정된 옵션이 기존 weight에 의한 FairShare를 무시하고 설정되는 것을 볼 수 있다.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="../assets/hadoop/../../../assets/hadoop/fair_share_min_resources.png" alt="Fair Share - Min Resources" /></p><h4 id="limiting-applications">Limiting Applications</h4><p>Queue에서 동작하는 Application의 수를 제어하고 싶은 경우, <code class="language-plaintext highlighter-rouge">maxRunningApps</code>와 <code class="language-plaintext highlighter-rouge">maxAMShare</code> 옵션을 사용할 수 있다.</p><ul><li><code class="language-plaintext highlighter-rouge">maxRunningApps</code>는 Queue에서 실행할 수 있는 Application의 수이다.<li><code class="language-plaintext highlighter-rouge">maxAMShare</code>는 Queue에서 Application Master Container가 사용할 수 있는 리소스의 양을 의미한다.<ul><li>리소스는 부족한데 <code class="language-plaintext highlighter-rouge">maxAMShare</code> 값이 크다면 Application들이 동시에 수행되었을 경우 Queue의 모든 Resource를 Application Master Container들이 점유하여 실제 작업을 수행하는 Non Application Master Container들이 수행되지 못해, 전체 작업이 수행되지 않는 상황이 발생할 수 있다.<li>기본 값은 0.5로 설정되어 있다.</ul></ul><h5 id="maxrunningapps-설정해보기">maxRunningApps 설정해보기</h5><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>&lt;allocations&gt;
  &lt;queue name="marketing"&gt;
    &lt;weight&gt;2.0&lt;/weight&gt;
    &lt;schedulingPolicy&gt;fair&lt;/schedulingPolicy&gt;
    &lt;maxResources&gt;4096mb, 4 vcores&lt;/maxResources&gt;
    &lt;maxRunningApps&gt;0&lt;/maxRunningApps&gt;
  &lt;/queue&gt;
  &lt;queue name="development"&gt;
    &lt;weight&gt;8.0&lt;/weight&gt;
    &lt;schedulingPolicy&gt;fair&lt;/schedulingPolicy&gt;
    &lt;maxResources&gt;4096mb, 4 vcores&lt;/maxResources&gt;
  &lt;/queue&gt;
  &lt;queueMaxAMShareDefault&gt;0.5&lt;/queueMaxAMShareDefault&gt;
&lt;/allocations&gt;
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">marketing</code> Queue의 <code class="language-plaintext highlighter-rouge">maxRunningApps</code>를 0으로 설정한 후 Application을 실행해보았다.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="../assets/hadoop/../../../assets/hadoop/max_app_running_0.png" alt="Max App Running 0" /></p><p>클러스터와 Queue의 가용 리소스가 충분한데도, Application이 ACCEPTED 상태로 되어 있는 것을 확인할 수 있다.</p><h5 id="maxamshare-설정해보기">maxAMShare 설정해보기</h5><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>&lt;allocations&gt;
  &lt;queue name="marketing"&gt;
    &lt;weight&gt;2.0&lt;/weight&gt;
    &lt;schedulingPolicy&gt;fair&lt;/schedulingPolicy&gt;
    &lt;maxResources&gt;4096mb, 4 vcores&lt;/maxResources&gt;
    &lt;maxAMShare&gt;0&lt;/maxAMShare&gt;
  &lt;/queue&gt;
  &lt;queue name="development"&gt;
    &lt;weight&gt;8.0&lt;/weight&gt;
    &lt;schedulingPolicy&gt;fair&lt;/schedulingPolicy&gt;
    &lt;maxResources&gt;4096mb, 4 vcores&lt;/maxResources&gt;
  &lt;/queue&gt;
  &lt;queueMaxAMShareDefault&gt;0.5&lt;/queueMaxAMShareDefault&gt;
&lt;/allocations&gt;
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">marketing</code> Queue의 <code class="language-plaintext highlighter-rouge">maxAMShare</code>를 0으로 설정한 후 Application을 실행해보았다.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="../assets/hadoop/../../../assets/hadoop/max_am_share_0.png" alt="Max AM Share 0" /></p><p>클러스터와 Queue의 가용 리소스가 충분한데도, Application이 ACCEPTED 상태로 되어 있는 것을 확인할 수 있다. 위의 <code class="language-plaintext highlighter-rouge">maxRunningApps</code>와 다른 점은, <code class="language-plaintext highlighter-rouge">maxRunningApps</code>의 <code class="language-plaintext highlighter-rouge">marketing</code> Queue 상태에는 <code class="language-plaintext highlighter-rouge">maxRunningApps</code>에 Max Running Applications가 0으로 설정되어 있어 왜 Application이 수행되지 않는지 알 수 있지만, <code class="language-plaintext highlighter-rouge">maxAMShare</code>의 경우 아무런 옵션도 써있지 않아 구분이 힘들다는 점이 있다.</p><h3 id="preemption">Preemption</h3><p>Preemption은 Queue들이 FairShare만큼의 리소스를 보장받을 수 있도록, FairShare를 넘겨 리소스를 사용 중인 Queue의 Allocation된 Container를 Kill 하므로써 리소스를 뺏어오는 방법이다.</p><h4 id="steady-fairshare-vs-instantaneous-fairshare">Steady FairShare vs Instantaneous FairShare</h4><ul><li><p>Steady FairShare: 각 Queue에 적용되는 이론적인 FairShare 값을 의미한다. &lt;memory:100GB, vcores: 100&gt;인 클러스터에 <code class="language-plaintext highlighter-rouge">marketing</code>과 <code class="language-plaintext highlighter-rouge">development</code> Queue가 각각 0.2, 0.8만큼의 Weight를 가지고 있다면 <strong>클러스터 상태와는 관계 없이</strong> &lt;memory: 20GB, vcores: 20&gt;과 &lt;memory: 80GB, vcores: 80&gt;의 Steady FairShare를 가지게 된다.</p><li><p>Instantaneous FairShare: 실행 중인 Application을 가진 Queue들의 Weight로만 계산된 FairShare를 의미한다. 위 Steady FairShare 구성에서 <code class="language-plaintext highlighter-rouge">marketing</code> Queue에서 실행 중인 Application이 없고, <code class="language-plaintext highlighter-rouge">development</code> Queue에는 실행 중인 Application이 존재하는 경우 <code class="language-plaintext highlighter-rouge">marketing</code>과 <code class="language-plaintext highlighter-rouge">development</code> Queue의 Instantaneous FairShare는 &lt;memory:0GB, vcores: 0&gt;과 &lt;memory:100GB, vcores: 20&gt;이 된다.</p></ul><h4 id="configuring-fair-scheduler-for-preemption">Configuring Fair Scheduler for Preemption</h4><p>preemption을 활성화하기 위해서는 <code class="language-plaintext highlighter-rouge">yarn-site.xml</code>에 아래 설정을 추가해야 한다.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>&lt;property&gt;yarn.scheduler.fair.preemption&lt;/property&gt;
&lt;value&gt;true&lt;/value&gt;
</pre></table></code></div></div><p>Queue에 적용 가능한 옵션은 <code class="language-plaintext highlighter-rouge">fairSharePreemptionThreshold</code>와 <code class="language-plaintext highlighter-rouge">fairSharePreemptionTimeout</code>이다. Preemption은 <code class="language-plaintext highlighter-rouge">Ìnstantaneous FairShare</code> &lt; <code class="language-plaintext highlighter-rouge">Steady FairShare * fairSharePreemptionThreshold</code> 인 상태가 <code class="language-plaintext highlighter-rouge">fairSharePreemptionTimeout</code>만큼 지속되면 발생한다.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>&lt;?xml version="1.0"?&gt;
&lt;allocations&gt;
  &lt;queue name="marketing"&gt;
    &lt;weight&gt;4.0&lt;/weight&gt;
    &lt;schedulingPolicy&gt;fair&lt;/schedulingPolicy&gt;
    &lt;fairSharePreemptionThreshold&gt;1.0&lt;/fairSharePreemptionThreshold&gt;
    &lt;fairSharePreemptionTimeout&gt;1&lt;/fairSharePreemptionTimeout&gt;
  &lt;/queue&gt;
  &lt;queue name="development"&gt;
    &lt;weight&gt;6.0&lt;/weight&gt;
    &lt;schedulingPolicy&gt;fair&lt;/schedulingPolicy&gt;
    &lt;fairSharePreemptionThreshold&gt;1.0&lt;/fairSharePreemptionThreshold&gt;
    &lt;fairSharePreemptionTimeout&gt;1&lt;/fairSharePreemptionTimeout&gt;
  &lt;/queue&gt;
  &lt;queueMaxAMShareDefault&gt;0.5&lt;/queueMaxAMShareDefault&gt;

&lt;/allocations&gt;
</pre></table></code></div></div><p>위와 같이 설정하는 경우 <code class="language-plaintext highlighter-rouge">marketing</code>와 <code class="language-plaintext highlighter-rouge">development</code>에 모두 Application이 있을 때, 각각 3,276, 4,915만큼의 FairShare 보장을 1초라도 못받게 되면 Preemption이 발생하게 된다.</p><p>맨 처음 <code class="language-plaintext highlighter-rouge">marketing</code> Queue에 Application을 실행했을 경우엔 아래와 같이 <code class="language-plaintext highlighter-rouge">marketing</code> Queue의 FairShare가 8,192가 된다.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="../assets/hadoop/../../../assets/hadoop/preemption0.png" alt="Preemption 0" /></p><p>이 상태에서 <code class="language-plaintext highlighter-rouge">development</code> Queue에 Application을 실행하는 경우, 일시적으로 <code class="language-plaintext highlighter-rouge">marketing</code> Queue가 자신의 Steady Fair Share보다 더 많은 Instantaneous Fair Share보다 많은 리소스를 할당받은 <code class="language-plaintext highlighter-rouge">Over Fair Share</code> 상태가 된다.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="../assets/hadoop/../../../assets/hadoop/preemption1.png" alt="Preemption 1" /></p><p><code class="language-plaintext highlighter-rouge">development</code>에 설정된 preemption 옵션에 따라 1초(<code class="language-plaintext highlighter-rouge">fairSharePreemptionTimeout</code>) 후 Preemption이 동작한다. 이 때의 Yarn의 Resource Manager 로그에서는 다음과 같이 <code class="language-plaintext highlighter-rouge">marketing</code> Queue가 초과 선점한 리소스에 대한 Preemption을 수행한다는 로그가 발생하며</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>2019-11-16 12:55:20,033 INFO org.apache.hadoop.yarn.server.resourcemanager.scheduler.fair.FairScheduler: Should preempt &lt;memory:1024, vCores:-6&gt; res for queue root.marketing: resDueToMinShare = &lt;memory:0, vCores:0&gt;, resDueToFairShare = &lt;memory:1024, vCores:-6&gt;
2019-11-16 12:55:55,159 INFO org.apache.hadoop.yarn.server.resourcemanager.scheduler.fair.FairScheduler: Preempting container (prio=20res=&lt;memory:1024, vCores:1&gt;) from queue root.marketing
</pre></table></code></div></div><p>실제로 Preemption이 발생하며 <code class="language-plaintext highlighter-rouge">development</code> Queue에 존재하는 Application도 RUNNING 상태로 변경되며 실행된다.(다만 그림에서는 Preemption 직후의 상황을 캡쳐하여 아직 <code class="language-plaintext highlighter-rouge">marketing</code> Queue가 <code class="language-plaintext highlighter-rouge">Over Fair Share</code> 상태이다)</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="../assets/../../assets/hadoop/preemption2.png" alt="Preemption 2" /></p><p>이 때 Preemption 당한 Application을 보면 아래와 같이 Killed 상태의 Container가 존재하며,</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="../assets/../../assets/hadoop/preemption3.png" alt="Preemption 3" /></p><p>Killed된 Container의 Reason에는 Scheduler에 의해 Preemption 되었다는 내용을 확인할 수 있다.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="../assets/../../assets/hadoop/preemption4.png" alt="Preemption 4" /></p></div><div class="post-tail-wrapper text-muted"><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/apache-hadoop/" class="post-tag no-text-decoration" >apache-hadoop</a> <a href="/tags/study/" class="post-tag no-text-decoration" >study</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Apache Hadoop - Fair Scheduler - leeyh0216's devlog&url=https://leeyh0216.github.io/posts/Fair_Scheduler/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Apache Hadoop - Fair Scheduler - leeyh0216's devlog&u=https://leeyh0216.github.io/posts/Fair_Scheduler/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Apache Hadoop - Fair Scheduler - leeyh0216's devlog&url=https://leeyh0216.github.io/posts/Fair_Scheduler/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ps/">ps</a> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/leetcode/">leetcode</a> <a class="post-tag" href="/tags/apache-spark/">apache-spark</a> <a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/kafka/">kafka</a> <a class="post-tag" href="/tags/apache-druid/">apache-druid</a> <a class="post-tag" href="/tags/string/">string</a> <a class="post-tag" href="/tags/study/">study</a> <a class="post-tag" href="/tags/docker/">docker</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Apache_Druid_Getting_Started/"><div class="card-body"> <span class="timeago small" > Oct 26, 2019 <i class="unloaded">2019-10-26T22:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Apache Druid - Getting started</h3><div class="text-muted small"><p> 스터디를 위해 Apache Druid 공식 문서를 번역/요약한 문서입니다. Getting started Introduction to Apache Druid Druid란? Apache Druid는 대규모 데이터를 대상으로 slice-and-dice 분석을 지원하기 위해 만들어진 실시간 분석용 데이터베이스이다. slice and di...</p></div></div></a></div><div class="card"> <a href="/posts/Apache_Druid_Design/"><div class="card-body"> <span class="timeago small" > Nov 5, 2019 <i class="unloaded">2019-11-05T10:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Apache Druid - Design</h3><div class="text-muted small"><p> 스터디를 위해 Apache Druid 공식 문서를 번역/요약한 문서입니다. Design 출처: Apache druid - architecture Druid는 Multi process로 구성된 분산 아키텍쳐를 가지고 있다. 각 Process는 독립적으로 구성/확장될 수 있어 클러스터에 맞게 탄력적으로 운영할 수 있다. 이러한 설계는...</p></div></div></a></div><div class="card"> <a href="/posts/Apache_Druid-Segments/"><div class="card-body"> <span class="timeago small" > Nov 10, 2019 <i class="unloaded">2019-11-10T15:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Apache Druid - Segments</h3><div class="text-muted small"><p> 스터디를 위해 Apache Druid 공식 문서를 번역/요약한 문서입니다. Segments Apache Druid는 시간 기준으로 파티셔닝된 색인을 Segment 파일에 저장한다. 하나의 Segment 파일은 Ingestion 단계에서 정의한 granularitySpec의 segmentGranulairty 만큼의 Time Interval을 ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Apache_Druid-Segments/" class="btn btn-outline-primary" prompt="Older"><p>Apache Druid - Segments</p></a> <a href="/posts/SearchSuggestionsSystem/" class="btn btn-outline-primary" prompt="Newer"><p>LeetCode - Search Suggestions System</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://twitter.com/username">leeyh0216</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/ps/">ps</a> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/leetcode/">leetcode</a> <a class="post-tag" href="/tags/apache-spark/">apache spark</a> <a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/kafka/">kafka</a> <a class="post-tag" href="/tags/apache-druid/">apache druid</a> <a class="post-tag" href="/tags/string/">string</a> <a class="post-tag" href="/tags/study/">study</a> <a class="post-tag" href="/tags/docker/">docker</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://leeyh0216.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
