<!DOCTYPE html><html lang="ko-KR" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8829030678254956" crossorigin="anonymous"></script><meta name="pv-proxy-endpoint" content=""><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Inversion of Control Containers and the Dependency Injection pattern" /><meta name="author" content="leeyh0216" /><meta property="og:locale" content="ko_KR" /><meta name="description" content="이 글은 Martin Fowler의 Inversion of Control Containers and the Dependency Injection pattern을 요약 정리한 글입니다. Inversion of Control Containers and the Dependency Injection pattern 많은 오픈소스들은 J2EE 기술에 대한 대안을 구축하는 다양한 활동을 하고 있다. 이러한 활동은 J2EE의 복잡도를 획기적인 방법으로 낮추기 위함이다. 이들이 다루는 공통적인 이슈는 서로 다른 요소들을 어떻게 결합하는지에 대한 것이다. 이러한 문제를 해결하기 위해 많은 프레임워크들이 등장했고, 몇몇 프레임워크는 다른 레이어에 있는 요소(컴포넌트)들을 조합하는 방식을 제공한다. 이러한 방식은 Lightweight Container(경량화된 컨테이너)라고 불리운다. Component and Service 컴포넌트: 어플리케이션에서 사용될 목적으로 만들어진 소프트웨어 구성 요소이며, 컴포넌트는 컴포넌트 작성자가 허용하는 방식으로만 확장이 가능하다. 서비스: 컴포넌트와 비슷하지만, 외부 어플리케이션에서 사용한다는 점에서 차이를 보인다. 컴포넌트는 Jar, Assembly, DLL 등을 통해 제공되어 로컬에서 사용하며, 서비스는 웹서비스, 메시징 시스템, RPC, Socket 등의 원격 인터페이스를 통해 사용된다. A Naive Example 원본 글에서 아래와 같은 예제가 제공된다. class MovieLister{ public Movie[] moviesDirectedBy(String arg) { List allMovies = finder.findAll(); for(Iterator it = allMovies.iterator(); it.hasNext();) { Movie movie = (Movie)it.next(); if (!movie.getDirector().equals(arg)) it.remove(); } } return (Movie[])allMovies.toArray(new Movie[allMovies.size()]); } 영화 목록 중 인자로 주어진 값을 영화 감독으로 가지는 영화를 추출하여 반환하는 moviesDirectedBy 라는 메서드가 정의되어 있는 MovieLister라는 클래스를 제공하고 있다. 위 예제의 요점은 ‘MovieLister 객체와 Finder 객체를 연결하는 법‘이다. MovieLister 객체는 영화가 어떻게 저장되는지에 대해서는 전혀 관심이 없다. 단지 조건에 부합하는 영화를 moviesDirectedBy 메서드로 찾고 싶을 뿐이다. 즉, Finder 객체와의 의존성을 없애고 싶은 것이다. 이러한 문제를 해결하기 위해 Finder 객체를 아래와 같이 Interface로 정의하였다. public interface MovieFinder { List findAll(); } Finder를 Interface로 정의하므로써, Finder와 MovieLister 객체의 분리는 잘 된 것 같다. 그러나 아래와 같이 MovieLister 클래스의 생성자에서 Finder 객체를 상속한 ColonDelimitedMovieFinder 클래스의 객체를 명시적으로 할당해준다면 어떨까? class MovieLister { private MovieFinder finder; public MovieLister() { this.finder = new ColonDelimitedMovieFinder(&quot;movies1.txt&quot;); } } 코드의 작성자만 사용할 때는 문제가 없지만, 다른 사람이 위 클래스를 사용하게 된다면 ColonDelimitedMovieFinder 클래스의 생성자로 전달되는 “movies1.txt” 변경 불가 텍스트 파일이 아닌 XML 혹은 SQL 등에 영화 목록이 저장되어 있을 경우 사용 불가 와 같은 문제점에 부딪히게 된다. 위 그림에서와 같이 MovieLister가 MovieFinder Interface에 의존하지만, 동시에 이를 상속하는 Concrete Class인 MovieFinderImpl을 생성하므로써 둘 모두에 의존성이 생기게 된다. 즉, MovieFinder를 Interface로 만든 보람이 없어지게 된다. MovieLister와 MovieFinder를 제대로 Decouple 시키기 위해서는, 아래 MovieFinderImpl에 대한 의존성을 완전히 없애야 한다. 이러한 문제는 Plugin 패턴으로 해결할 수 있고, 이러한 Plugin을 어플리케이션에 조합해서 넣는 방법을 IoC를 사용하므로써 해결할 수 있다. Plugin 이란? Interface는 어플리케이션 코드가 서로 다른 구현을 필요로 하는 여러 런타임 환경에서 동작할 때 주로 사용된다. 개발자는 Interface를 적절히 구현하여 Factory Method에 제공(리턴)한다. 예를 들어 위 그림에서 DomainObject 객체가 Primiary Key를 생성해야 할 때, Unit Test 환경에서는 In-Memory Counter를 사용하고, Production 환경에서는 Database Managed Sequence를 사용해야 한다. 만일 IdGenerator를 제공하는 Factory Method를 직접 구현한다면, 조건문을 사용해서 실행 환경에 따라 일일이 다른 IdGenerator 구현체를 반환해야 할 것이다. 이러한 경우 실행 환경, 배포 환경 등이 바뀔 때마다 모든 Factory 의 조건문을 수정해야하는 상황이 발생할 수 있다. Plugin은 중앙화된 런타임 구성을 제공하므로써 이러한 문제를 해결한다. IoC(Inversion of Control) 위의 A Naive Exmple 에서 MovieLister 클래스는 MovieFinder를 상속한 구현체를 생성자에서 인스턴스화하였다. 이는 MovieFinder가 Plugin 화 될 수 없게 만든다. 이를 가능하게 하기 위해서는, 별도의 Assembly" /><meta property="og:description" content="이 글은 Martin Fowler의 Inversion of Control Containers and the Dependency Injection pattern을 요약 정리한 글입니다. Inversion of Control Containers and the Dependency Injection pattern 많은 오픈소스들은 J2EE 기술에 대한 대안을 구축하는 다양한 활동을 하고 있다. 이러한 활동은 J2EE의 복잡도를 획기적인 방법으로 낮추기 위함이다. 이들이 다루는 공통적인 이슈는 서로 다른 요소들을 어떻게 결합하는지에 대한 것이다. 이러한 문제를 해결하기 위해 많은 프레임워크들이 등장했고, 몇몇 프레임워크는 다른 레이어에 있는 요소(컴포넌트)들을 조합하는 방식을 제공한다. 이러한 방식은 Lightweight Container(경량화된 컨테이너)라고 불리운다. Component and Service 컴포넌트: 어플리케이션에서 사용될 목적으로 만들어진 소프트웨어 구성 요소이며, 컴포넌트는 컴포넌트 작성자가 허용하는 방식으로만 확장이 가능하다. 서비스: 컴포넌트와 비슷하지만, 외부 어플리케이션에서 사용한다는 점에서 차이를 보인다. 컴포넌트는 Jar, Assembly, DLL 등을 통해 제공되어 로컬에서 사용하며, 서비스는 웹서비스, 메시징 시스템, RPC, Socket 등의 원격 인터페이스를 통해 사용된다. A Naive Example 원본 글에서 아래와 같은 예제가 제공된다. class MovieLister{ public Movie[] moviesDirectedBy(String arg) { List allMovies = finder.findAll(); for(Iterator it = allMovies.iterator(); it.hasNext();) { Movie movie = (Movie)it.next(); if (!movie.getDirector().equals(arg)) it.remove(); } } return (Movie[])allMovies.toArray(new Movie[allMovies.size()]); } 영화 목록 중 인자로 주어진 값을 영화 감독으로 가지는 영화를 추출하여 반환하는 moviesDirectedBy 라는 메서드가 정의되어 있는 MovieLister라는 클래스를 제공하고 있다. 위 예제의 요점은 ‘MovieLister 객체와 Finder 객체를 연결하는 법‘이다. MovieLister 객체는 영화가 어떻게 저장되는지에 대해서는 전혀 관심이 없다. 단지 조건에 부합하는 영화를 moviesDirectedBy 메서드로 찾고 싶을 뿐이다. 즉, Finder 객체와의 의존성을 없애고 싶은 것이다. 이러한 문제를 해결하기 위해 Finder 객체를 아래와 같이 Interface로 정의하였다. public interface MovieFinder { List findAll(); } Finder를 Interface로 정의하므로써, Finder와 MovieLister 객체의 분리는 잘 된 것 같다. 그러나 아래와 같이 MovieLister 클래스의 생성자에서 Finder 객체를 상속한 ColonDelimitedMovieFinder 클래스의 객체를 명시적으로 할당해준다면 어떨까? class MovieLister { private MovieFinder finder; public MovieLister() { this.finder = new ColonDelimitedMovieFinder(&quot;movies1.txt&quot;); } } 코드의 작성자만 사용할 때는 문제가 없지만, 다른 사람이 위 클래스를 사용하게 된다면 ColonDelimitedMovieFinder 클래스의 생성자로 전달되는 “movies1.txt” 변경 불가 텍스트 파일이 아닌 XML 혹은 SQL 등에 영화 목록이 저장되어 있을 경우 사용 불가 와 같은 문제점에 부딪히게 된다. 위 그림에서와 같이 MovieLister가 MovieFinder Interface에 의존하지만, 동시에 이를 상속하는 Concrete Class인 MovieFinderImpl을 생성하므로써 둘 모두에 의존성이 생기게 된다. 즉, MovieFinder를 Interface로 만든 보람이 없어지게 된다. MovieLister와 MovieFinder를 제대로 Decouple 시키기 위해서는, 아래 MovieFinderImpl에 대한 의존성을 완전히 없애야 한다. 이러한 문제는 Plugin 패턴으로 해결할 수 있고, 이러한 Plugin을 어플리케이션에 조합해서 넣는 방법을 IoC를 사용하므로써 해결할 수 있다. Plugin 이란? Interface는 어플리케이션 코드가 서로 다른 구현을 필요로 하는 여러 런타임 환경에서 동작할 때 주로 사용된다. 개발자는 Interface를 적절히 구현하여 Factory Method에 제공(리턴)한다. 예를 들어 위 그림에서 DomainObject 객체가 Primiary Key를 생성해야 할 때, Unit Test 환경에서는 In-Memory Counter를 사용하고, Production 환경에서는 Database Managed Sequence를 사용해야 한다. 만일 IdGenerator를 제공하는 Factory Method를 직접 구현한다면, 조건문을 사용해서 실행 환경에 따라 일일이 다른 IdGenerator 구현체를 반환해야 할 것이다. 이러한 경우 실행 환경, 배포 환경 등이 바뀔 때마다 모든 Factory 의 조건문을 수정해야하는 상황이 발생할 수 있다. Plugin은 중앙화된 런타임 구성을 제공하므로써 이러한 문제를 해결한다. IoC(Inversion of Control) 위의 A Naive Exmple 에서 MovieLister 클래스는 MovieFinder를 상속한 구현체를 생성자에서 인스턴스화하였다. 이는 MovieFinder가 Plugin 화 될 수 없게 만든다. 이를 가능하게 하기 위해서는, 별도의 Assembly" /><link rel="canonical" href="https://leeyh0216.github.io/posts/ioc_and_di_pattern/" /><meta property="og:url" content="https://leeyh0216.github.io/posts/ioc_and_di_pattern/" /><meta property="og:site_name" content="leeyh0216’s devlog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2018-12-19T10:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Inversion of Control Containers and the Dependency Injection pattern" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@leeyh0216" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"leeyh0216"},"description":"이 글은 Martin Fowler의 Inversion of Control Containers and the Dependency Injection pattern을 요약 정리한 글입니다. Inversion of Control Containers and the Dependency Injection pattern 많은 오픈소스들은 J2EE 기술에 대한 대안을 구축하는 다양한 활동을 하고 있다. 이러한 활동은 J2EE의 복잡도를 획기적인 방법으로 낮추기 위함이다. 이들이 다루는 공통적인 이슈는 서로 다른 요소들을 어떻게 결합하는지에 대한 것이다. 이러한 문제를 해결하기 위해 많은 프레임워크들이 등장했고, 몇몇 프레임워크는 다른 레이어에 있는 요소(컴포넌트)들을 조합하는 방식을 제공한다. 이러한 방식은 Lightweight Container(경량화된 컨테이너)라고 불리운다. Component and Service 컴포넌트: 어플리케이션에서 사용될 목적으로 만들어진 소프트웨어 구성 요소이며, 컴포넌트는 컴포넌트 작성자가 허용하는 방식으로만 확장이 가능하다. 서비스: 컴포넌트와 비슷하지만, 외부 어플리케이션에서 사용한다는 점에서 차이를 보인다. 컴포넌트는 Jar, Assembly, DLL 등을 통해 제공되어 로컬에서 사용하며, 서비스는 웹서비스, 메시징 시스템, RPC, Socket 등의 원격 인터페이스를 통해 사용된다. A Naive Example 원본 글에서 아래와 같은 예제가 제공된다. class MovieLister{ public Movie[] moviesDirectedBy(String arg) { List allMovies = finder.findAll(); for(Iterator it = allMovies.iterator(); it.hasNext();) { Movie movie = (Movie)it.next(); if (!movie.getDirector().equals(arg)) it.remove(); } } return (Movie[])allMovies.toArray(new Movie[allMovies.size()]); } 영화 목록 중 인자로 주어진 값을 영화 감독으로 가지는 영화를 추출하여 반환하는 moviesDirectedBy 라는 메서드가 정의되어 있는 MovieLister라는 클래스를 제공하고 있다. 위 예제의 요점은 ‘MovieLister 객체와 Finder 객체를 연결하는 법‘이다. MovieLister 객체는 영화가 어떻게 저장되는지에 대해서는 전혀 관심이 없다. 단지 조건에 부합하는 영화를 moviesDirectedBy 메서드로 찾고 싶을 뿐이다. 즉, Finder 객체와의 의존성을 없애고 싶은 것이다. 이러한 문제를 해결하기 위해 Finder 객체를 아래와 같이 Interface로 정의하였다. public interface MovieFinder { List findAll(); } Finder를 Interface로 정의하므로써, Finder와 MovieLister 객체의 분리는 잘 된 것 같다. 그러나 아래와 같이 MovieLister 클래스의 생성자에서 Finder 객체를 상속한 ColonDelimitedMovieFinder 클래스의 객체를 명시적으로 할당해준다면 어떨까? class MovieLister { private MovieFinder finder; public MovieLister() { this.finder = new ColonDelimitedMovieFinder(&quot;movies1.txt&quot;); } } 코드의 작성자만 사용할 때는 문제가 없지만, 다른 사람이 위 클래스를 사용하게 된다면 ColonDelimitedMovieFinder 클래스의 생성자로 전달되는 “movies1.txt” 변경 불가 텍스트 파일이 아닌 XML 혹은 SQL 등에 영화 목록이 저장되어 있을 경우 사용 불가 와 같은 문제점에 부딪히게 된다. 위 그림에서와 같이 MovieLister가 MovieFinder Interface에 의존하지만, 동시에 이를 상속하는 Concrete Class인 MovieFinderImpl을 생성하므로써 둘 모두에 의존성이 생기게 된다. 즉, MovieFinder를 Interface로 만든 보람이 없어지게 된다. MovieLister와 MovieFinder를 제대로 Decouple 시키기 위해서는, 아래 MovieFinderImpl에 대한 의존성을 완전히 없애야 한다. 이러한 문제는 Plugin 패턴으로 해결할 수 있고, 이러한 Plugin을 어플리케이션에 조합해서 넣는 방법을 IoC를 사용하므로써 해결할 수 있다. Plugin 이란? Interface는 어플리케이션 코드가 서로 다른 구현을 필요로 하는 여러 런타임 환경에서 동작할 때 주로 사용된다. 개발자는 Interface를 적절히 구현하여 Factory Method에 제공(리턴)한다. 예를 들어 위 그림에서 DomainObject 객체가 Primiary Key를 생성해야 할 때, Unit Test 환경에서는 In-Memory Counter를 사용하고, Production 환경에서는 Database Managed Sequence를 사용해야 한다. 만일 IdGenerator를 제공하는 Factory Method를 직접 구현한다면, 조건문을 사용해서 실행 환경에 따라 일일이 다른 IdGenerator 구현체를 반환해야 할 것이다. 이러한 경우 실행 환경, 배포 환경 등이 바뀔 때마다 모든 Factory 의 조건문을 수정해야하는 상황이 발생할 수 있다. Plugin은 중앙화된 런타임 구성을 제공하므로써 이러한 문제를 해결한다. IoC(Inversion of Control) 위의 A Naive Exmple 에서 MovieLister 클래스는 MovieFinder를 상속한 구현체를 생성자에서 인스턴스화하였다. 이는 MovieFinder가 Plugin 화 될 수 없게 만든다. 이를 가능하게 하기 위해서는, 별도의 Assembly","url":"https://leeyh0216.github.io/posts/ioc_and_di_pattern/","@type":"BlogPosting","headline":"Inversion of Control Containers and the Dependency Injection pattern","dateModified":"2018-12-19T10:00:00+09:00","datePublished":"2018-12-19T10:00:00+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://leeyh0216.github.io/posts/ioc_and_di_pattern/"},"@context":"https://schema.org"}</script><title>Inversion of Control Containers and the Dependency Injection pattern | leeyh0216's devlog</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/npm/countup.js@1.9.3/dist/countUp.min.js"></script> <script async src="/assets/js/dist/pvreport.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-129061352-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-129061352-1'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://cdn.jsdelivr.net/gh/cotes2020/chirpy-images/commons/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">leeyh0216's devlog</a></div><div class="site-subtitle font-italic">개발/일상 블로그</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/leeyh0216" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://www.linkedin.com/in/%EC%9A%A9%ED%99%98-%EC%9D%B4-84222a119/" aria-label="linkedin" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['leeyh0216','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Inversion of Control Containers and the Dependency Injection pattern</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Inversion of Control Containers and the Dependency Injection pattern</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> leeyh0216 </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Dec 19, 2018, 10:00 AM +0900" prep="on" > Dec 19, 2018 <i class="unloaded">2018-12-19T10:00:00+09:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1303 words">7 min</span> <span id="pv" class="pageviews"><i class="fas fa-spinner fa-spin fa-fw"></i></span></div></div><div class="post-content"><blockquote><p>이 글은 Martin Fowler의 Inversion of Control Containers and the Dependency Injection pattern을 요약 정리한 글입니다.</p></blockquote><h1 id="inversion-of-control-containers-and-the-dependency-injection-pattern">Inversion of Control Containers and the Dependency Injection pattern</h1><p>많은 오픈소스들은 J2EE 기술에 대한 대안을 구축하는 다양한 활동을 하고 있다. 이러한 활동은 J2EE의 복잡도를 획기적인 방법으로 낮추기 위함이다.</p><p>이들이 다루는 공통적인 이슈는 서로 다른 요소들을 어떻게 결합하는지에 대한 것이다. 이러한 문제를 해결하기 위해 많은 프레임워크들이 등장했고, 몇몇 프레임워크는 다른 레이어에 있는 요소(컴포넌트)들을 조합하는 방식을 제공한다. 이러한 방식은 Lightweight Container(경량화된 컨테이너)라고 불리운다.</p><h2 id="component-and-service">Component and Service</h2><ul><li><p>컴포넌트: 어플리케이션에서 사용될 목적으로 만들어진 소프트웨어 구성 요소이며, 컴포넌트는 컴포넌트 작성자가 허용하는 방식으로만 확장이 가능하다.</p><li><p>서비스: 컴포넌트와 비슷하지만, 외부 어플리케이션에서 사용한다는 점에서 차이를 보인다.</p></ul><p>컴포넌트는 Jar, Assembly, DLL 등을 통해 제공되어 로컬에서 사용하며, 서비스는 웹서비스, 메시징 시스템, RPC, Socket 등의 원격 인터페이스를 통해 사용된다.</p><h1 id="a-naive-example">A Naive Example</h1><p>원본 글에서 아래와 같은 예제가 제공된다.</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">class</span> <span class="nc">MovieLister</span><span class="o">{</span>

    <span class="kd">public</span> <span class="nc">Movie</span><span class="o">[]</span> <span class="nf">moviesDirectedBy</span><span class="o">(</span><span class="nc">String</span> <span class="n">arg</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">List</span> <span class="n">allMovies</span> <span class="o">=</span> <span class="n">finder</span><span class="o">.</span><span class="na">findAll</span><span class="o">();</span>
        <span class="k">for</span><span class="o">(</span><span class="nc">Iterator</span> <span class="n">it</span> <span class="o">=</span> <span class="n">allMovies</span><span class="o">.</span><span class="na">iterator</span><span class="o">();</span> <span class="n">it</span><span class="o">.</span><span class="na">hasNext</span><span class="o">();)</span> <span class="o">{</span>
            <span class="nc">Movie</span> <span class="n">movie</span> <span class="o">=</span> <span class="o">(</span><span class="nc">Movie</span><span class="o">)</span><span class="n">it</span><span class="o">.</span><span class="na">next</span><span class="o">();</span>
            <span class="k">if</span> <span class="o">(!</span><span class="n">movie</span><span class="o">.</span><span class="na">getDirector</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">arg</span><span class="o">))</span> <span class="n">it</span><span class="o">.</span><span class="na">remove</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="o">(</span><span class="nc">Movie</span><span class="o">[])</span><span class="n">allMovies</span><span class="o">.</span><span class="na">toArray</span><span class="o">(</span><span class="k">new</span> <span class="nc">Movie</span><span class="o">[</span><span class="n">allMovies</span><span class="o">.</span><span class="na">size</span><span class="o">()]);</span>
<span class="o">}</span></code></pre></figure><p>영화 목록 중 인자로 주어진 값을 영화 감독으로 가지는 영화를 추출하여 반환하는 <code class="language-plaintext highlighter-rouge">moviesDirectedBy</code> 라는 메서드가 정의되어 있는 <code class="language-plaintext highlighter-rouge">MovieLister</code>라는 클래스를 제공하고 있다.</p><p>위 예제의 요점은 ‘<strong>MovieLister 객체와 Finder 객체를 연결하는 법</strong>‘이다. <code class="language-plaintext highlighter-rouge">MovieLister</code> 객체는 영화가 어떻게 저장되는지에 대해서는 전혀 관심이 없다. 단지 조건에 부합하는 영화를 <code class="language-plaintext highlighter-rouge">moviesDirectedBy</code> 메서드로 찾고 싶을 뿐이다. 즉, <code class="language-plaintext highlighter-rouge">Finder</code> 객체와의 의존성을 없애고 싶은 것이다.</p><p>이러한 문제를 해결하기 위해 <code class="language-plaintext highlighter-rouge">Finder</code> 객체를 아래와 같이 <code class="language-plaintext highlighter-rouge">Interface</code>로 정의하였다.</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">MovieFinder</span> <span class="o">{</span>
    <span class="nc">List</span> <span class="nf">findAll</span><span class="o">();</span>
<span class="o">}</span></code></pre></figure><p><code class="language-plaintext highlighter-rouge">Finder</code>를 Interface로 정의하므로써, <code class="language-plaintext highlighter-rouge">Finder</code>와 <code class="language-plaintext highlighter-rouge">MovieLister</code> 객체의 분리는 잘 된 것 같다. 그러나 아래와 같이 <code class="language-plaintext highlighter-rouge">MovieLister</code> 클래스의 생성자에서 <code class="language-plaintext highlighter-rouge">Finder</code> 객체를 상속한 <code class="language-plaintext highlighter-rouge">ColonDelimitedMovieFinder</code> 클래스의 객체를 명시적으로 할당해준다면 어떨까?</p><figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">class</span> <span class="nc">MovieLister</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">MovieFinder</span> <span class="n">finder</span><span class="o">;</span>
    <span class="kd">public</span> <span class="nf">MovieLister</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">finder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ColonDelimitedMovieFinder</span><span class="o">(</span><span class="s">"movies1.txt"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure><p>코드의 작성자만 사용할 때는 문제가 없지만, 다른 사람이 위 클래스를 사용하게 된다면</p><ul><li>ColonDelimitedMovieFinder 클래스의 생성자로 전달되는 “movies1.txt” 변경 불가<li>텍스트 파일이 아닌 XML 혹은 SQL 등에 영화 목록이 저장되어 있을 경우 사용 불가</ul><p>와 같은 문제점에 부딪히게 된다.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/spring/both_dependency.jpeg" alt="Dependency Issue" /></p><p>위 그림에서와 같이 <code class="language-plaintext highlighter-rouge">MovieLister</code>가 <code class="language-plaintext highlighter-rouge">MovieFinder</code> Interface에 의존하지만, 동시에 이를 상속하는 Concrete Class인 <code class="language-plaintext highlighter-rouge">MovieFinderImpl</code>을 생성하므로써 둘 모두에 의존성이 생기게 된다. 즉, <code class="language-plaintext highlighter-rouge">MovieFinder</code>를 Interface로 만든 보람이 없어지게 된다. <code class="language-plaintext highlighter-rouge">MovieLister</code>와 <code class="language-plaintext highlighter-rouge">MovieFinder</code>를 제대로 Decouple 시키기 위해서는, 아래 <code class="language-plaintext highlighter-rouge">MovieFinderImpl</code>에 대한 의존성을 완전히 없애야 한다.</p><p>이러한 문제는 Plugin 패턴으로 해결할 수 있고, 이러한 Plugin을 어플리케이션에 조합해서 넣는 방법을 IoC를 사용하므로써 해결할 수 있다.</p><h3 id="plugin-이란">Plugin 이란?</h3><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/spring/plugin.jpg" alt="Plugin" /></p><p>Interface는 어플리케이션 코드가 서로 다른 구현을 필요로 하는 여러 런타임 환경에서 동작할 때 주로 사용된다. 개발자는 Interface를 적절히 구현하여 Factory Method에 제공(리턴)한다.</p><p>예를 들어 위 그림에서 DomainObject 객체가 Primiary Key를 생성해야 할 때, Unit Test 환경에서는 In-Memory Counter를 사용하고, Production 환경에서는 Database Managed Sequence를 사용해야 한다.</p><p>만일 IdGenerator를 제공하는 Factory Method를 직접 구현한다면, 조건문을 사용해서 실행 환경에 따라 일일이 다른 IdGenerator 구현체를 반환해야 할 것이다. 이러한 경우 실행 환경, 배포 환경 등이 바뀔 때마다 모든 Factory 의 조건문을 수정해야하는 상황이 발생할 수 있다.</p><p>Plugin은 중앙화된 런타임 구성을 제공하므로써 이러한 문제를 해결한다.</p><h2 id="iocinversion-of-control">IoC(Inversion of Control)</h2><p>위의 A Naive Exmple 에서 <code class="language-plaintext highlighter-rouge">MovieLister</code> 클래스는 <code class="language-plaintext highlighter-rouge">MovieFinder</code>를 상속한 구현체를 생성자에서 인스턴스화하였다. 이는 <code class="language-plaintext highlighter-rouge">MovieFinder</code>가 Plugin 화 될 수 없게 만든다. 이를 가능하게 하기 위해서는, 별도의 Assembly</p></div><div class="post-tail-wrapper text-muted"><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/spring/" class="post-tag no-text-decoration" >spring</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Inversion of Control Containers and the Dependency Injection pattern - leeyh0216's devlog&url=https://leeyh0216.github.io/posts/ioc_and_di_pattern/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Inversion of Control Containers and the Dependency Injection pattern - leeyh0216's devlog&u=https://leeyh0216.github.io/posts/ioc_and_di_pattern/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Inversion of Control Containers and the Dependency Injection pattern - leeyh0216's devlog&url=https://leeyh0216.github.io/posts/ioc_and_di_pattern/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ps/">ps</a> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/leetcode/">leetcode</a> <a class="post-tag" href="/tags/apache-spark/">apache-spark</a> <a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/kafka/">kafka</a> <a class="post-tag" href="/tags/apache-druid/">apache-druid</a> <a class="post-tag" href="/tags/string/">string</a> <a class="post-tag" href="/tags/study/">study</a> <a class="post-tag" href="/tags/docker/">docker</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/spring-cloud-zuul/"><div class="card-body"> <span class="timeago small" > Nov 10, 2018 <i class="unloaded">2018-11-10T15:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Spring Cloud - Zuul(1)</h3><div class="text-muted small"><p> 개요 2017년 후반부터 2018년 초까지 팀 내 서비스들을 마이크로서비스 아키텍쳐 형태로 개발하는 프로젝트를 진행하였다. 사내에서 L7 Switch를 제공하고 있었지만, 서비스가 추가될 때마다 요청하기도 번거롭고 Software Level Gateway에서만 할 수 있는 작업들도 여럿 있었다. 당시에 Gateway 후보로 Spring Cloud...</p></div></div></a></div><div class="card"> <a href="/posts/spring-core-4/"><div class="card-body"> <span class="timeago small" > Dec 23, 2018 <i class="unloaded">2018-12-23T10:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Spring Core Technologies - The IoC Container(4)</h3><div class="text-muted small"><p> The IoC Container Dependencies 간단한 어플리케이션부터 기업형 어플리케이션까지 하나의 객체로만 동작하는 프로그램은 없다. 적어도 몇개의 객체들이 서로 상호작용하며 어플리케이션을 구성하고 있다. Dependency Injection 의존성 주입(Dependency Injection, D.I)은 객체들이 자신의 의존성(의존 ...</p></div></div></a></div><div class="card"> <a href="/posts/spring-rabbitmq-1/"><div class="card-body"> <span class="timeago small" > Dec 30, 2018 <i class="unloaded">2018-12-30T10:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Spring with RabbitMQ(1)</h3><div class="text-muted small"><p> Spring with RabbitMQ Pre Requirements RabbitMQ 3.6 RabbitMQ 설치(Docker) RabbitMQ를 물리 서버에 설치하기 위해서는 Erlang 설치를 선행한 후 RabbitMQ를 설치해야 하지만 테스트 용도이기 때문에 Docker로 설치 진행한다. Docker Hub의 RabbitMQ 페이지...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/spring-core-3/" class="btn btn-outline-primary" prompt="Older"><p>Spring Core Technologies - The IoC Container(3)</p></a> <a href="/posts/spring-core-4/" class="btn btn-outline-primary" prompt="Newer"><p>Spring Core Technologies - The IoC Container(4)</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://twitter.com/username">leeyh0216</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/ps/">ps</a> <a class="post-tag" href="/tags/spring/">spring</a> <a class="post-tag" href="/tags/leetcode/">leetcode</a> <a class="post-tag" href="/tags/apache-spark/">apache spark</a> <a class="post-tag" href="/tags/java/">java</a> <a class="post-tag" href="/tags/kafka/">kafka</a> <a class="post-tag" href="/tags/apache-druid/">apache druid</a> <a class="post-tag" href="/tags/string/">string</a> <a class="post-tag" href="/tags/study/">study</a> <a class="post-tag" href="/tags/docker/">docker</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://leeyh0216.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
